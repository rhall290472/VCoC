<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Google Sheets Viewer</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }

    #sheetSelector {
      margin-bottom: 20px;
      padding: 10px;
      font-size: 16px;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      max-width: 800px;
      margin-bottom: 20px;
    }

    th,
    td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }

    th {
      background-color: #f2f2f2;
    }

    .loader {
      display: none;
      margin: 20px 0;
    }

    .sheet-section {
      margin-top: 30px;
    }

    .sheet-section h2 {
      margin-bottom: 10px;
    }
  </style>
</head>

<body>
  <h1>Google Sheets Viewer</h1>
  <select id="sheetSelector" onchange="jumpToSheet()">
    <option value="">Jump to Sheet</option>
  </select>
  <div id="loader" class="loader">Loading...</div>
  <div id="sheetContent"></div>

  <script>
    // Replace with your Google Sheets API key and Spreadsheet ID
    const API_KEY = 'AIzaSyBcU - XdpJ1rmLpKoivnnF1LdFNmmxR - E1U';
    const SPREADSHEET_ID = '159vsu7eJsrCUQ_9vHnP5dHUJ2BwrwzeQ-qhvX64PIwY';

    // Function to fetch sheet names and populate dropdown
    async function loadSheetNames() {
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}?key=${API_KEY}`;
      try {
        const response = await fetch(url);
        const data = await response.json();
        const sheetSelector = document.getElementById('sheetSelector');

        // Populate dropdown with sheet names
        data.sheets.forEach(sheet => {
          const option = document.createElement('option');
          option.value = sheet.properties.title;
          option.textContent = sheet.properties.title;
          sheetSelector.appendChild(option);
        });

        // Load all sheets
        await loadAllSheets(data.sheets);
      } catch (error) {
        console.error('Error fetching sheet names:', error);
        document.getElementById('sheetContent').innerHTML = '<p>Error loading sheets. Please check your API key and spreadsheet ID.</p>';
      }
    }

    // Function to load and display all sheets
    async function loadAllSheets(sheets) {
      const loader = document.getElementById('loader');
      const sheetContent = document.getElementById('sheetContent');
      loader.style.display = 'block';
      sheetContent.innerHTML = '';

      for (const sheet of sheets) {
        const sheetName = sheet.properties.title;
        const section = document.createElement('div');
        section.className = 'sheet-section';
        section.id = `sheet-${sheetName.replace(/\s+/g, '-')}`; // Create anchor ID
        const title = document.createElement('h2');
        title.textContent = sheetName;
        section.appendChild(title);

        const url = `https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/${encodeURIComponent(sheetName)}?key=${API_KEY}`;
        try {
          const response = await fetch(url);
          const data = await response.json();

          if (data.values) {
            // Create table for each sheet
            const table = document.createElement('table');
            data.values.forEach((row, rowIndex) => {
              const tr = document.createElement('tr');
              row.forEach(cell => {
                const cellElement = rowIndex === 0 ? 'th' : 'td';
                const td = document.createElement(cellElement);
                td.textContent = cell;
                tr.appendChild(td);
              });
              table.appendChild(tr);
            });
            section.appendChild(table);
          } else {
            section.innerHTML += '<p>No data found in this sheet.</p>';
          }
        } catch (error) {
          console.error(`Error fetching data for sheet ${sheetName}:`, error);
          section.innerHTML += '<p>Error loading sheet data.</p>';
        }
        sheetContent.appendChild(section);
      }
      loader.style.display = 'none';
    }

    // Function to jump to a specific sheet section
    function jumpToSheet() {
      const sheetName = document.getElementById('sheetSelector').value;
      if (sheetName) {
        const sectionId = `sheet-${sheetName.replace(/\s+/g, '-')}`;
        const section = document.getElementById(sectionId);
        if (section) {
          section.scrollIntoView({ behavior: 'smooth' });
        }
      }
    }

    // Initialize by loading sheet names and all sheets
    loadSheetNames();
  </script>
</body>

</html>